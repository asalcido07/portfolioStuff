{"filter":false,"title":"saveblogtext.php","tooltip":"/project/saveblogtext.php","undoManager":{"mark":0,"position":0,"stack":[[{"start":{"row":0,"column":0},"end":{"row":41,"column":2},"action":"remove","lines":["<?php","    session_start();","    ","    // If the user is not logged in, then redirect to home page","    if (!isset($_SESSION[\"username\"])) {","        header('Location: ./');","        exit();","    }","    ","    // If user clicked Cancel, then redirect to the view blog page","    if (isset($_POST['cancel'])) {","        header('Location: viewblog.php?u=' . $_SESSION['username']);","        exit();","    }","    ","    // Send to home page if submitted data is not valid","    if (!isset($_POST['blogtext'])){","        header('Location: ./');","        exit();","    }","    ","    // Assume that the Save button was clicked","    ","    //Extract submitted blogtext","    $blogtext = $_POST['blogtext'];","    ","    // Connect to database","    try {","        $dbh = new PDO(\"mysql:host=localhost;dbname=blog\", \"root\", NULL);","    } catch (PDOExecption $e) {","        exit('Database connection failed: ' . $e->getMessage());","    }","    ","    // Retrieve the actual password for given user","    $stmt = $dbh->prepare(\"UPDATE users SET blogtext = :blogtext WHERE username = :username\"); // Sets statement for mysql, increments counter when page is viewed","    $stmt->bindParam(':blogtext', $blogtext);","    $stmt->bindParam(':username', $_SESSION[\"username\"]);","    $stmt->execute() or exit(\"UPDATE failed.\"); // Executes $stmt","","    // Redirect to othe view blog page so the user can visually confirm the changes","    header('Location: ./viewblog.php?u=' . $_SESSION['username']);","?>"],"id":1},{"start":{"row":0,"column":0},"end":{"row":41,"column":2},"action":"insert","lines":["<?php","    session_start();","    ","    // If the user is not logged in, then redirect to home page","    if (!isset($_SESSION[\"username\"])) {","        header('Location: ./');","        exit();","    }","    ","    // If user clicked Cancel, then redirect to the view blog page","    if (isset($_POST['cancel'])) {","        header('Location: viewblog.php?u=' . $_SESSION['username']);","        exit();","    }","    ","    // Send to home page if submitted data is not valid","    if (!isset($_POST['blogtext'])){","        header('Location: ./');","        exit();","    }","    ","    // Assume that the Save button was clicked","    ","    //Extract submitted blogtext","    $blogtext = $_POST['blogtext'];","    ","    // Connect to database","    try {","        $dbh = new PDO(\"mysql:host=localhost;dbname=project\", \"root\", NULL);","    } catch (PDOExecption $e) {","        exit('Database connection failed: ' . $e->getMessage());","    }","    ","    // Retrieve the actual password for given user","    $stmt = $dbh->prepare(\"UPDATE users SET blogtext = :blogtext WHERE username = :username\"); // Sets statement for mysql, increments counter when page is viewed","    $stmt->bindParam(':blogtext', $blogtext);","    $stmt->bindParam(':username', $_SESSION[\"username\"]);","    $stmt->execute() or exit(\"UPDATE failed.\"); // Executes $stmt","","    // Redirect to othe view blog page so the user can visually confirm the changes","    header('Location: ./viewblog.php?u=' . $_SESSION['username']);","?>"]}]]},"ace":{"folds":[],"scrolltop":120,"scrollleft":0,"selection":{"start":{"row":41,"column":2},"end":{"row":41,"column":2},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1465787733994,"hash":"464f43100caa26add75463dd85c49706e07ac24a"}